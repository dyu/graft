Next tasks:
- consume commits in the write pages handler
- write end-to-end write segment test